$(document).ready(function(){var e=getLocalStorage("publications");var d=getLocalStorage("mediaBias");var c="http://spectrum-backend.herokuapp.com/feeds/publications";function a(g){var f={};g.forEach(function(h){if(!h.fields.skip_scaping){f[h.fields.base_url]=h}});return f}function b(){var g=window.location;var f=spectrum.init(g);chrome.runtime.onMessage.addListener(function(h){if(h.action==="hideSpectrumPanel"){setLocalStorage(h.showType,h.typeButton);if(h.showType==="hidden"){f._hideContainer(h.typeButton)}else{f._hideIcon()}}});chrome.runtime.onMessage.addListener(function(h){if(h.action==="showSpectrumPanel"){setLocalStorage(h.showType,null);if(h.showType==="hidden"){f._showContainer();f.getAssociations(2)}else{f._showIcon()}}});chrome.runtime.onMessage.addListener(function(k,j,h){if(k.action==="getLocalStorage"){var i={};k.localValues.forEach(function(l){i[l]=getLocalStorage(l)});h(i)}})}if(e&&d){b()}else{$.ajax({url:c,type:"GET",}).fail(function(g,f,h){logError("Failed to get publications and media biases",g,f,h)}).done(function(f){e=a(f.publications);d=f.media_bias;setLocalStorage("publications",e);setLocalStorage("mediaBias",d);b()})}});