function sendMessage(a,b){chrome.tabs.query({active:true,currentWindow:true},function(c){var d=c[0].id;chrome.tabs.sendMessage(d,a,b)})}function addSpectrumEvents(){var b=$(".spectrum-popup-body");var d=b.find(".spectrum-close");var e=b.find(".spectrum-minimize");var a=b.find(".spectrum-no-button");chrome.runtime.sendMessage({action:"getLocalStorage",localValues:["hidden","hiddenIcon"],},function(f){if(!f){f={hidden:undefined,hiddenIcon:undefined,}}sendMessage({action:"hasCurrentArticle",},function(g){if(g){b.removeClass("spectrum-disabled")}if(f.hidden==="spectrum-close"){d.filter(".spectrum-hide-panel").hide()}else{d.filter(".spectrum-show-option").hide()}if(f.hidden==="spectrum-minimize"){e.filter(".spectrum-hide-panel").hide()}else{e.filter(".spectrum-show-option").hide()}if(f.hiddenIcon){a.filter(".spectrum-hide-panel").hide()}else{a.filter(".spectrum-show-option").hide()}});b.on("click.sendClick","li",function(h){var i="."+h.currentTarget.className.replace(/ /g,".");var g={element_selector:i,clicked_item_dict:JSON.stringify({element_class:i,element_data:h.currentTarget.dataset,element_text:h.currentTarget.textContent,}),};chrome.runtime.sendMessage({action:"sendClick",dataParam:g,})})});function c(g,f){if(g==="hidden"){if(f==="spectrum-minimize"){e.toggle()}else{d.toggle()}}else{a.toggle()}}b.find(".spectrum-get-involved > a").on("click.openEmail",function(f){f.preventDefault();chrome.tabs.query({active:true},function(g){chrome.tabs.update(g[0].id,{url:f.target.href})})});b.on("click.hidePanel",".spectrum-hide-panel",function(h){if($(h.target).closest(".spectrum-disabled").length){return}var g=h.target.dataset;var f={action:"hideSpectrumPanel",typeButton:g.hideType,showType:g.showType,};c(g.showType,g.hideType);sendMessage(f)});b.on("click.showPanel",".spectrum-show-option",function(g){if($(g.target).closest(".spectrum-disabled").length){return}var h=g.target.dataset.showType;var f={action:"showSpectrumPanel",showType:h,};c(h,g.target.dataset.hideType);sendMessage(f)})}document.addEventListener("DOMContentLoaded",function(){addSpectrumEvents()});