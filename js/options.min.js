var unique_id;var settingURL="https://spectrum-backend.herokuapp.com/feeds/saveuser";function getRandomToken(){var a=new Uint8Array(32);crypto.getRandomValues(a);var c="";for(var b=0;b<a.length;++b){c+=a[b].toString(16)}return c}function saveOptions(){var d=document.getElementById("hidden").value;var c=document.getElementById("hiddenIcon").checked?"spectrum-no-button":null;var e=document.getElementById("username").value;var b={hidden:d,hiddenIcon:c,username:e,is_internal_user:e.indexOf("test")>=0,};if(!unique_id){unique_id=e+"-"+getRandomToken()}b.unique_id=unique_id;var a=document.getElementById("status");$.ajax({url:settingURL,data:b,type:"POST",}).fail(function(g,f,h){a.textContent="Failed to save settings: "+g.responseJSON.message;console.log("req",g);console.log("textstatus",f);console.log("errorthrown",h)}).done(function(f){chrome.storage.sync.set(b,function(){a.textContent=f.message;setTimeout(function(){a.textContent=""},1500)})})}function restoreOptions(){chrome.storage.sync.get({hidden:"",hiddenIcon:null,username:"",unique_id:"",},function(a){document.getElementById("hidden").value=a.hidden||"";document.getElementById("hiddenIcon").checked=!!a.hiddenIcon;document.getElementById("username").value=a.username;unique_id=a.unique_id})}document.addEventListener("DOMContentLoaded",restoreOptions);document.getElementById("save").addEventListener("click",saveOptions);