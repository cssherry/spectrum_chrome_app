var settingURL="https://spectrum-backend.herokuapp.com/feeds/saveuser";function saveOptions(){var c=document.getElementById("hidden").value;var b=document.getElementById("hiddenIcon").checked?"spectrum-no-button":null;var d=document.getElementById("username").value;var a={hidden:c,hiddenIcon:b,username:d,};chrome.runtime.sendMessage({action:"setOrGetUniqueId",username:d,},function(f){a.unique_id=f.unique_id;a.is_internal_user=f.is_internal_user;var e=document.getElementById("status");$.ajax({url:settingURL,data:a,type:"POST",}).fail(function(h,g,i){if(h.responseJSON){e.textContent="Failed to save settings: "+h.responseJSON.message}else{e.textContent="Failed to save settings"}e.className="spectrum-status-error";console.log("req",h);console.log("textstatus",g);console.log("errorthrown",i)}).done(function(g){chrome.storage.sync.set(a,function(){e.textContent=g.message;e.className="spectrum-status-success";setTimeout(function(){e.textContent="";e.className=""},2000)})})})}function restoreOptions(){chrome.storage.sync.get({hidden:"",hiddenIcon:null,username:"",},function(a){document.getElementById("hidden").value=a.hidden||"";document.getElementById("hiddenIcon").checked=!!a.hiddenIcon;document.getElementById("username").value=a.username;$("#user-form").off("change.sendClick").on("change.sendClick",function(d){var c="#"+d.target.id;var b={element_selector:c,clicked_item_dict:JSON.stringify({element_id:d.target.id,element_name:d.target.name,value:d.target.value,}),};chrome.runtime.sendMessage({action:"sendClick",dataParam:b,})})})}document.addEventListener("DOMContentLoaded",restoreOptions);document.getElementById("save").addEventListener("click",saveOptions);